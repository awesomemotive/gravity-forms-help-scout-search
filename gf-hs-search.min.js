jQuery(document).ready(function(e){var t=e.extend(GF_HS_Settings,{searching:!1,cancelled:!1,count:0,query:"",timeout:null,wrap:e(".gform_wrapper .gfield.helpscout-docs"),field:e(".gform_wrapper .gfield.helpscout-docs").find('input[type="text"]'),results:{},init:function(){t.wrap.append('<div class="'+GF_HS_Settings.template.wrap_class+'" style="display:none;" />'),t.field.attr("autocomplete","off").on("keydown keyup change",t.search_changed)},search_changed:function(s){var n=[9,16,17,18,20,32,33,34,37,38,91,93];if(n.indexOf(s.which)>-1)return void t.log("Ignored key press",s.which);t.log("Starting search countdown in %d ms",parseInt(GF_HS_Settings.searchDelay,10));var r=e(this);clearTimeout(t.timeout),t.timeout=setTimeout(function(){return t.log("Performing search",s.which),t.query=r.val(),t.query.length<GF_HS_Settings.minLength||(8===s.which||46===s.which)&&0===t.query.length?(t.cancelled=!0,void t.set_results({})):void(t.searching||t.perform_search())},parseInt(GF_HS_Settings.searchDelay,10))},perform_search:function(){t.results={},t.cancelled=!1,t.fetch_results()},log:function(e,s){t.debug&&console&&console.log&&console.log(e,s)},get_results_html:function(){var s="",n=0;return"undefined"!=typeof t.results.articles&&t.results.articles.items.length&&(s=GF_HS_Settings.template.before,e.each(t.results.articles.items,function(r,i){var a=!0;GF_HS_Settings.collections.length>0&&(a=!1,e.each(GF_HS_Settings.collections,function(e,t){i.collectionId==t&&(a=!0)})),n<t.limit&&a&&(n++,s+=t.get_article_html(i))}),s+=GF_HS_Settings.template.after),t.get_results_found(n)+s},get_article_html:function(e){var t=GF_HS_Settings.template.item;for(var s in e)e.hasOwnProperty(s)&&(t=t.replace("{"+s+"}",e[s]));return t},get_results_found:function(e){var s="",n="results-found";return 0===t.query.length?(s=GF_HS_Settings.text.enter_search,n+=" message-enter_search"):t.query.length<t.minLength?(s=GF_HS_Settings.text.not_long_enough.replace("{minLength}",t.minLength),n+=" message-minlength"):0===e?(s=GF_HS_Settings.text.no_results_found,n+=" message-no_results"):(s=1===e?GF_HS_Settings.text.result_found:GF_HS_Settings.text.results_found,n+=" message-results"),GF_HS_Settings.template.results_found.replace("{css_class}",n).replace("{text}",s).replace("{count}",e)},set_results:function(e){t.log("Adding results:",e),t.results=e,t.wrap.find(".docs-search-wrap").html(t.get_results_html()).not(":visible").slideDown()},sanitize_query:function(e){return e=e.replace(/[\{\}\[\]]/g," "),t.log("Searching for %s",e),e},fetch_results:function(){query=t.sanitize_query(t.query),$search_wrap=t.wrap.find(".docs-search-wrap"),e.ajax({url:"https://docsapi.helpscout.net/v1/search/articles?status=published&visibility=public&query="+encodeURIComponent(query),async:!0,contentType:"application/json",dataType:"json",headers:{Authorization:"Basic "+GF_HS_Settings._basic_auth},xhrFields:{withCredentials:!1},beforeSend:function(){t.searching=!0,$search_wrap.addClass("docs-searching")},success:function(e){t.cancelled||t.set_results(e)},error:function(e){t.log("Error: %s",e)}}).always(function(){t.searching=!1,$search_wrap.removeClass("docs-searching")})}});t.init()});