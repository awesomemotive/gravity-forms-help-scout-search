jQuery(document).one("gform_post_render",function(){if(!window.hasOwnProperty("GF_HS_Settings")){console.error("There was a problem localizing Help Scout settings.");return}var HS_Search=jQuery.extend(GF_HS_Settings,{searching:false,cancelled:false,has_searched:false,count:0,query:"",timeout:null,wrap:jQuery(".gform_wrapper .gfield.helpscout-docs"),form:jQuery(".gform_wrapper .gfield.helpscout-docs").closest(".gform_wrapper"),field:jQuery(".gform_wrapper .gfield.helpscout-docs").find('input[type="text"]'),onclick:"",keypress:"",results:{},init:function(){HS_Search.form.find(".gform_next_button").hide();HS_Search.form.on("keypress",function(e){var code=e.which||e.keyCode;if(!HS_Search.field.is(":focus")){return}if(code==13&&!jQuery(e.target).is('textarea,input[type="submit"],input[type="button"]')){e.preventDefault();return false}});HS_Search.wrap.append('<div class="'+GF_HS_Settings.template.wrap_class+'" style="display:none;" />');HS_Search.field.attr("autocomplete","off").on("keydown keyup change",HS_Search.search_changed)},search_changed:function(e){var ignored_key_codes=[9,13,16,17,18,20,32,33,34,37,38,91,93];if(ignored_key_codes.indexOf(e.which)>-1){HS_Search.log("Ignored key press",e.which);return}HS_Search.log("Starting search countdown in %d ms",parseInt(GF_HS_Settings.searchDelay,10));var $el=jQuery(this);clearTimeout(HS_Search.timeout);HS_Search.timeout=setTimeout(function(){HS_Search.log("Performing search",e.which);HS_Search.query=$el.val();if(HS_Search.query.length<GF_HS_Settings.minLength||(8===e.which||46===e.which)&&HS_Search.query.length===0){HS_Search.cancelled=true;HS_Search.set_results({});return}if(!HS_Search.searching){HS_Search.perform_search()}},parseInt(GF_HS_Settings.searchDelay,10))},perform_search:function(){HS_Search.results={};HS_Search.cancelled=false;HS_Search.fetch_results()},log:function(item,item2){if(HS_Search.debug&&console&&console.log){console.log(item,item2)}},get_results_html:function(){var output="",count=0;if("undefined"!==typeof HS_Search.results.articles&&HS_Search.results.articles.results.length){output=GF_HS_Settings.template.before;jQuery.each(HS_Search.results.articles.results,function(key,article){var keep=true;if(GF_HS_Settings.collections.length>0){keep=false;jQuery.each(GF_HS_Settings.collections,function(collection_key,value){var regex=new RegExp("^/docs/"+value);if(regex.exec(article.docsUrl)){keep=true}})}if(count<HS_Search.limit&&keep){count++;output+=HS_Search.get_article_html(article)}});output+=GF_HS_Settings.template.after}return HS_Search.get_results_found(count)+output},get_article_html:function(article){var output=GF_HS_Settings.template.item;for(var key in article){if(article.hasOwnProperty(key)){output=output.split("{"+key+"}").join(article[key]);output=output.split("{"+key+"|esc}").join(HS_Search.esc_html(article[key]).replace(/\s+/g," "))}}return output},esc_html:function(str){return String(str).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/,"&#039;")},get_results_found:function(count){var found_text="";var css_class="results-found";if(HS_Search.query.length===0){found_text=GF_HS_Settings.text.enter_search;css_class+=" message-enter_search"}else if(HS_Search.query.length<HS_Search.minLength){found_text=GF_HS_Settings.text.not_long_enough.replace("{minLength}",HS_Search.minLength);css_class+=" message-minlength"}else if(0===count){found_text=GF_HS_Settings.text.no_results_found;css_class+=" message-no_results"}else{found_text=count===1?GF_HS_Settings.text.result_found:GF_HS_Settings.text.results_found;css_class+=" message-results"}return GF_HS_Settings.template.results_found.replace("{css_class}",css_class).replace("{text}",found_text).replace("{count}",count)},set_results:function(results){HS_Search.log("Adding results:",results);HS_Search.results=results;HS_Search.wrap.find(".docs-search-wrap").html(HS_Search.get_results_html()).not(":visible").slideDown()},sanitize_query:function(query){query=query.replace(/[\{\}\[\]]/g," ");HS_Search.log("Searching for %s",query);return query},fetch_results:function(){query=HS_Search.sanitize_query(HS_Search.query);$search_wrap=HS_Search.wrap.find(".docs-search-wrap");jQuery.ajax({url:"https://"+GF_HS_Settings._subdomain+".helpscoutdocs.com/search/ajax?ref=gf&query="+encodeURIComponent(query),async:true,dataType:"json",beforeSend:function(){HS_Search.searching=true;$search_wrap.addClass("docs-searching");HS_Search.wrap.find(".docs-search-wrap").show().html('<span class="gf-hs-spinner"></span>');jQuery("body").trigger("gf_hs_search_started")},success:function(results){if(!HS_Search.cancelled){HS_Search.set_results(results);HS_Search.form.find(".gform_next_button").show();jQuery("body").trigger("gf_hs_search_results_found");HS_Search.has_searched=true}},error:function(e){HS_Search.log("Error: %s",e);jQuery("body").trigger("gf_hs_search_error")}}).always(function(){HS_Search.searching=false;$search_wrap.removeClass("docs-searching")})}});HS_Search.init()});